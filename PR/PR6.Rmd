---
title: "PR6"
author: "Lee Yu bin"
date: "2018년 10월 18일"
output: word_document
---

# 함수와 사용자정의 함수

## 함수
- 특정 목적에 맞게 생성된 연산과정의 집합
- ex) mean 함수: 모든 원소의 합을 원소의 개수로 나눔 

## 사용자 정의 함수
- 사용자의 편의에 따라 직접 작성하여 사용하는 함수 
- 함수명=function(인수){연산과정}형태로 작성(한가지 연산만 할 경우 {}로 묶지 않아도 됨)
- 연산과정으로 나오는 결과값을 return, print, cat 등으로 반환하는 형태가 이상적

## 예시1. 두 숫자를 비교해 더 큰수를 반환하는 함수
```{r}
# 2개의 숫자를 인수로 받아서 더 큰수를 반환하는 함수
compare <- function(x,y) if(x>y) cat(x) else(y)
compare(10, 20)
```

## 예시2. 평균값과 표준오차를 계산하는 함수
```{r}
# 표준오차 = 표준편차 / 표본의 크기

se <- function(x){
  tmp.sd <- sd(x)    #표준편차
  tmp.N <- length(x) #표본크기
  tmp.se <- tmp.sd / sqrt(tmp.N)  #평균의 표준오차
  return(tmp.se)
}

A <- c(1,2,3,4,5,6,7,8,9,10)
se(A)
```

## 예시3. 데이터 프레임의 앞뒤 3개의 데이터를 리스트로 보여주는 함수
```{r}
head_tail <- function(x){
  front <- head(x,3)   #데이터프레임 상위 3개 데이터 프레임 생성 
  rear <- tail(x,3)   #데이터프레임 하위 3개 데이터프레임 생성 
  F_R <- list(front,rear)   #2개 데이터프레임 리스트로 묶음  
  return(F_R)   #묶은 리스트 반환  
}

head_tail(mtcars)
```

## 예시4. 홀수 판별함수
```{r}
oddnum <- function(x){
  if(x%%2==1){   #2로 나눈 나머지가 1이면
    return(T)    #T를 반환 
    } else {     #그렇지 않으면 
      return(F)  #F를 반환 
    }
}
```

## scope of variable
- 함수 바깥에서 생성된 변수는 같은 함수 안에서는 언제나 사용가능 
- 함수 안에서 생성된 변수는 함수가 종료되면 사라짐 
- 함수 내에서 생성된 변수가 사라지지 않게 하려면 "<<-"을 할당 연산자로 사용
```{r}
# <- 할당연산자 사용
scopetest <- function(x){
  a <- 10
  print(a)
  print(x)
}

scopetest(9)

# print(a) #주석 제거후 함수실행하여 메세지 확인할 것 

# <<- 할당 연산자 사용 
scopetest <- function(x){
  a <<- 10
  print(a)
  print(x)
}

scopetest(9)

print(a)
```

## 연습문제
- PR2의 도전문제 2번을 활용한 문제입니다.
- 벡터 prices에 저장된 값은 2018-03-01부터 2018-03-06까지 bitcoin의 종가이다.
- 힌트를 참고하여 순서대로 2018-03-01부터 2018-03-06까지 6일간의 수익률을 구하는 함수를 만드세요.
- 함수의 이름은 in.rate로 지정해주세요.
- 함수를 사용하여 증가율을 출력해주세요.
```{r}
prices = c(11905000, 11973000, 12190000,12700000,12303000, 12604000) #prices에 저장된 값
names(prices) = paste0("2018", "-", "03", "-", "0", 1:6) #prices의 값에 paste0함수를 사용하여 이름을 붙여줌 
for(i in 1:6){             
  in.rate <- ((prices[i]-prices[i-1])/prices[i-1])*100  #수익률 구하는 식을 사용/ 금일을 i로 하고 전일을 i-1로 함.
  print(in.rate)
}
#2018-03-01의 수익률에서는 전일의 종가가 존재하지 않으므로 수익률을 구할 수 없다.
```

## 도전문제
- 어떤 문제를 수치 계산으로 풀지 않고 확률(난수)을 이용해서 푸는 것을 '몬테카를로법'이라 한다. 이방법으로 원주율 파이를 구할 수 있다.
- 점을 뽑을 갯수 n을 입력받아 파이를 추정하는 함수 mc_pi를 작성하세요.
- 점을 100개, 1000개, 10000개, 100000개, 1000000개 뽑았을 때 추정된 파이를 출력하고 실제 파이 값과 가까워지는지 확인하세요.
```{r}
mc_pi <- function(n){   #점을 뽑을 갯수 n을 입력받는 function생성
  a <- 0
  for(i in 1:n){
    b <- runif(2, min=0, max=1) 
    if(sqrt(b[1]^2 + b[2]^2) < 1){  #1/4원 외부에 표시된 난수의 값이 1이하이면 a+1
      a <- a + 1
    }
  }
  return(4 * a / n)  #PI구하는 함수 사용
}
for(i in 2:6){  #점을 100개, 1000개, 10000개, 100000개, 1000000개 뽑았을 때 추정된 파이 출력 
  mc_pi(10^i)
  print(mc_pi(10^i))
}
```